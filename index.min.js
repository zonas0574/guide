let target=document.querySelector(".addon");active(document.querySelector(".searchbar .item")),document.querySelector(".search").className="search showsearch",document.querySelector("#search").focus(),get("bookmarks.json",(function(res){let table=document.querySelector("#table");res.forEach(v=>{let tr=document.createElement("tr"),td=document.createElement("td");td.className="title",td.innerHTML=v.title,tr.appendChild(td),v.list.forEach(e=>{td=document.createElement("td"),td.innerHTML="<a href='"+e.url+"' target='_blank'>"+e.name+"</a>",tr.appendChild(td)}),table.appendChild(tr)})}));let img=localStorage.getItem("img");if(img){img=JSON.parse(img);let d=new Date,t;d.getFullYear()+""+(d.getMonth()+1)+(d.getDay()>9?d.getDate():"0"+d.getDate())>img.enddate?getBingImg():document.querySelector("body").style.backgroundImage="url("+img.url+")"}else getBingImg();function active(element){target.innerText=element.innerText,target.setAttribute("url",element.getAttribute("url")),search()}function search(){let key=document.querySelector("#search").value;""!=key.trim()&&window.open(target.getAttribute("url").replace("{}",key))}function getBingImg(){get("bingimg?format=js&idx=0&n=1",(function(res){res.images&&(document.querySelector("body").style.backgroundImage="url(https://s.cn.bing.net"+res.images[0].url+")",localStorage.setItem("img",JSON.stringify({enddate:res.images[0].enddate,url:"https://s.cn.bing.net"+res.images[0].url})))}))}function get(url,callback){var xhr=new XMLHttpRequest;xhr.open("GET",url,!0),xhr.send(),xhr.onreadystatechange=function(){200===xhr.status&&4===xhr.readyState&&callback(JSON.parse(xhr.response))}}document.querySelector("#search").addEventListener("keyup",(function(event){13===event.keyCode&&search()})),document.querySelectorAll(".searchbar > .item").forEach(e=>{e.addEventListener("click",(function(event){active(event.target)})),e.addEventListener("dblclick",(function(event){window.open(event.target.getAttribute("url").replace("{}",""))}))}),document.addEventListener("mousewheel",(function(e){(e=e||window.event).deltaY>0?(document.querySelector(".table").className="table showtable",document.querySelector(".search").className="search hidesearch"):(document.querySelector(".table").className="table hidetable",document.querySelector(".search").className="search showsearch")}));